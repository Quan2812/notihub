<div class="main-container">
  <div class="container-header">
    <div class="heading-left">
      <div class="wrapper">
        <h4>Tạo template</h4>
      </div>
    </div>
    <div class="step-bar">
      <div class="step-element finished">
        <div class="frame">
          <div class="rectangle"></div>
          <div class="step-icon">
            <div class="checks">
              <svg width="11" height="8" viewBox="0 0 11 8" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" clip-rule="evenodd"
                      d="M10.1196 0.154651C10.3793 0.381951 10.4056 0.776801 10.1784 1.03658L4.70965 7.28656C4.48315 7.54537 4.09015 7.57262 3.83017 7.3475L0.548922 4.50662C0.287959 4.28069 0.259572 3.88594 0.485509 3.625C0.711447 3.36406 1.10616 3.33562 1.36712 3.56156L4.17834 5.99556L9.23765 0.213445C9.46496 -0.0463298 9.85983 -0.0726548 10.1196 0.154651Z"
                      fill="white" />
              </svg>
            </div>
          </div>
          <div class="rectangle"></div>
        </div>
        <div class="frame-text">
          <span class="">Thông tin chung</span>
        </div>
      </div>

      <div class="step-element finished">
        <div class="frame">
          <div class="rectangle"></div>
          <div class="step-icon">
            <div class="checks">
              <svg width="11" height="8" viewBox="0 0 11 8" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" clip-rule="evenodd"
                      d="M10.1196 0.154651C10.3793 0.381951 10.4056 0.776801 10.1784 1.03658L4.70965 7.28656C4.48315 7.54537 4.09015 7.57262 3.83017 7.3475L0.548922 4.50662C0.287959 4.28069 0.259572 3.88594 0.485509 3.625C0.711447 3.36406 1.10616 3.33562 1.36712 3.56156L4.17834 5.99556L9.23765 0.213445C9.46496 -0.0463298 9.85983 -0.0726548 10.1196 0.154651Z"
                      fill="white" />
              </svg>
            </div>
          </div>
          <div class="rectangle after"></div>
        </div>
        <div class="frame-text">
          <span class="">Nội dung đa kênh</span>
        </div>
      </div>

      <div class="step-element processing">
        <div class="frame">
          <div class="rectangle"></div>
          <div class="step-icon">
            <div class="checks">
              <span>3</span>
            </div>
          </div>
          <div class="rectangle"></div>
        </div>
        <div class="frame-text">
          <span class="">Xác nhận</span>
        </div>
      </div>
    </div>
  </div>

  <div class="container-body">
    <div class="paragraph">
      <div class="row">
        <div class="title-col">
          <label>Tên template</label>
        </div>
        <div class="info-col">
          <span>KHUYẾN MÃI THẺ TÍN DỤNG</span>
        </div>
      </div>
      <div class="row">
        <div class="title-col">
          <label>Loại template</label>
        </div>
        <div class="info-col">
          <span>Tùy chỉnh</span>
        </div>
      </div>
      <div class="row">
        <div class="title-col">
          <label>Loại thông báo</label>
        </div>
        <div class="info-col">
          <span>Nhắc nhở</span>
        </div>
      </div>
      <div class="row">
        <div class="title-col">
          <label>Loại nghiệp vụ</label>
        </div>
        <div class="info-col">
          <span>Thẻ tín dụng</span>
        </div>
      </div>
      <div class="row">
        <div class="title-col">
          <label>Kênh gửi tin</label>
        </div>
        <div class="info-col flex-col">
          <span class="col-item">App</span>
          <span class="col-item">SMS</span>
        </div>
      </div>
    </div>
    <div class="collapse-item">
      <div class="collapse-item-header" onclick="toggleCollapse(this)">
        <label>Nội dung thông báo - App</label>
        <div class="collapse-icon">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path d="M4 6L8 10L12 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"
                  stroke-linejoin="round" />
          </svg>
        </div>
      </div>
      <div class="collapse-item-body">
        <div class="input-group-row">
          <div class="input-group">
            <label> Ứng dụng gửi tin</label>
            <input value="Information" />
          </div>
          <div class="input-group">
            <label> Tab hiển thị thông báo</label>
            <input value="Information" />
          </div>
        </div>

        <div class="input-group">
          <label>Tiêu đề</label>
          <input
            value="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed eget sem ut elit euismod dignissim et nec lacus. Cras volutpat nibh" />
          <p class="counter">0/100 kí tự</p>
        </div>

        <div class="thumbnail-group">
          <label>Ảnh thumbnail</label>
          <div class="thumbnail-item">
            <div class="link">
              <div class="image-icon">
                <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M13.5049 16.6146H4.45953C3.38286 16.6146 2.39828 16.0692 1.83161 15.1483C1.26495 14.2275 1.21536 13.1083 1.69703 12.1379L2.91536 9.69416C3.31203 8.90082 3.94953 8.40499 4.66495 8.32707C5.38036 8.24916 6.10995 8.60332 6.66245 9.29041L6.81828 9.48874C7.12995 9.87124 7.4912 10.0767 7.84536 10.0412C8.19953 10.0129 8.52536 9.75791 8.7662 9.32582L10.1049 6.91041C10.6574 5.91166 11.3941 5.39457 12.1945 5.42999C12.9879 5.47249 13.6679 6.06749 14.1212 7.11582L16.3383 12.2937C16.7491 13.25 16.6499 14.3408 16.0762 15.2121C15.5095 16.0975 14.5462 16.6146 13.5049 16.6146ZM4.86328 9.38957C4.83495 9.38957 4.80661 9.38957 4.77828 9.39666C4.42411 9.43207 4.09828 9.71541 3.86453 10.1758L2.6462 12.6196C2.32745 13.25 2.36286 13.9937 2.7312 14.5958C3.09953 15.1979 3.7512 15.5592 4.45953 15.5592H13.4979C14.192 15.5592 14.8083 15.2262 15.1908 14.6454C15.5733 14.0646 15.637 13.3704 15.3608 12.7329L13.1437 7.55499C12.8745 6.91749 12.4991 6.52791 12.1379 6.51374C11.8049 6.49249 11.3729 6.84666 11.0329 7.44874L9.69411 9.86416C9.28328 10.6008 8.6387 11.0612 7.93745 11.125C7.2362 11.1817 6.52078 10.8417 5.98953 10.1758L5.8337 9.97749C5.5362 9.58791 5.1962 9.38957 4.86328 9.38957Z" fill="#5D6573"/>
                  <path d="M5.4375 6.69791C3.97833 6.69791 2.78125 5.50791 2.78125 4.04166C2.78125 2.57541 3.97125 1.38541 5.4375 1.38541C6.90375 1.38541 8.09375 2.57541 8.09375 4.04166C8.09375 5.50791 6.90375 6.69791 5.4375 6.69791ZM5.4375 2.44791C4.55917 2.44791 3.84375 3.16332 3.84375 4.04166C3.84375 4.91999 4.55917 5.63541 5.4375 5.63541C6.31583 5.63541 7.03125 4.91999 7.03125 4.04166C7.03125 3.16332 6.31583 2.44791 5.4375 2.44791Z" fill="#5D6573"/>
                </svg>
              </div>
              <a href="images/previewimg.jpg">https://example.com/image.jpg</a>
            </div>
            <img class="preview-img" src="images/previewimg.jpg" />
          </div>
        </div>

        <div class="input-group">
          <label>Nội dung tóm tắt</label>
          <input
            value="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed eget sem ut elit euismod dignissim et nec lacus. Cras volutpat nibh" />
          <p class="counter">0/200 kí tự</p>
        </div>

        <div class="input-group">
          <label>Nội dung chi tiết</label>
          <input
            value="Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed eget sem ut elit euismod dignissim et nec lacus. Cras volutpat nibh" />
          <p class="counter">0/2500 kí tự</p>
        </div>
      </div>
    </div>

    <div class="collapse-item collapsed">
      <div class="collapse-item-header" onclick="toggleCollapse(this)">
        <label>Nội dung thông báo - SMS</label>
        <div class="collapse-icon">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path d="M4 6L8 10L12 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"
                  stroke-linejoin="round" />
          </svg>
        </div>
      </div>
      <div class="collapse-item-body collapsed">
      </div>
    </div>

    <div class="button-section">
      <a class="back-button" (click)="onBack()">
        <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M7.17758 14.1151C7.03508 14.1151 6.89258 14.0626 6.78008 13.9501L2.22758 9.39759C2.01008 9.18009 2.01008 8.82009 2.22758 8.60259L6.78008 4.05009C6.99758 3.83259 7.35758 3.83259 7.57508 4.05009C7.79258 4.26759 7.79258 4.62759 7.57508 4.84509L3.42008 9.00009L7.57508 13.1551C7.79258 13.3726 7.79258 13.7326 7.57508 13.9501C7.47008 14.0626 7.32008 14.1151 7.17758 14.1151Z"
            fill="#6D371A" />
          <path
            d="M15.3749 9.5625H2.75244C2.44494 9.5625 2.18994 9.3075 2.18994 9C2.18994 8.6925 2.44494 8.4375 2.75244 8.4375H15.3749C15.6824 8.4375 15.9374 8.6925 15.9374 9C15.9374 9.3075 15.6824 9.5625 15.3749 9.5625Z"
            fill="#6D371A" />
        </svg>
      </a>
      <div class="submit-button" (click)="onSubmit()">
        <span>Lưu</span>
      </div>
    </div>
  </div>
</div>

<script>
    function toggleCollapse(header) {
      const collapseItem = header.parentElement;
      const body = collapseItem.querySelector('.collapse-item-body');
      const icon = header.querySelector('.collapse-icon svg');
      const border = collapseItem.querySelector('.collapse-item');

      collapseItem.classList.toggle('collapsed');
    }

    function updateCharacterCount(input) {
      const counter = input.nextElementSibling;
      if (counter && counter.classList.contains('counter')) {
        const currentLength = input.value.length;
        const maxLength = counter.textContent.split('/')[1].split(' ')[0];
        counter.textContent = `${currentLength}/${maxLength} kí tự`;
      }
    }

    document.addEventListener('DOMContentLoaded', function () {
      const inputsWithCounter = document.querySelectorAll('.input-group input + .counter');

      inputsWithCounter.forEach(counter => {
        const input = counter.previousElementSibling;
        if (input && input.tagName === 'INPUT') {

          const maxLength = counter.textContent.split('/')[1].split(' ')[0];
          input.setAttribute('maxlength', maxLength);

          updateCharacterCount(input);


          input.addEventListener('input', function () {
            updateCharacterCount(this);
          });

          input.addEventListener('keyup', function () {
            updateCharacterCount(this);
          });

          input.addEventListener('paste', function () {

            setTimeout(() => {
              updateCharacterCount(this);
            }, 10);
          });
        }
      });
    });
  </script>
